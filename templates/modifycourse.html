{% extends "layout.html" %}
{% block title %}Kurssin muokkaus{% endblock %}

{% block content %}
<h2>Valittu kurssi: {{ course["name"] }} ({{ course["credits"] }} op)</h2>
{% if course["exercises"] is none %}
<h3>Kurssilla ei ole tehtäviä.</h3>
{% else %}
<h3>tehtäviä: {{ course["exercises"] }}</h3>
{% endif %}
<button onclick="openForm()">Lisää tehtävä</button>
<div id="exerciseform" style="display: none">
    <br>
    <button onclick="openTextExercise()">Tekstitehtävä </button>
    <button onclick="openMultipleChoiceExercise()">Monivalintatehtävä</button>
</div>
<div id="textform" style="display: none">
    <form action="/modifycourse?status=text_exercise_created" method="POST">
        <label for="exercise_name">Tehtävän kysymys:</label>
        <br>
        <input name="exercise_name" type="text" minlength="1" required>
        <br>
        Mallivastaus:
        <br>
        <textarea name="example_answer" rows="3" cols="50"></textarea>
        <br>
        <input type="submit" value="Luo tehtävä">
    </form>
</div>
<div id="multiplechoiceform" style="display: none">
    <form action="/modifycourse?status=multiple_choice_created" method="POST">
        <label for="exercise_name">Tehtävän kysymys:</label>
        <br>
        <input name="exercise_name" type="text" minlength="1" required>
        <br>
        Valinnat:
        <br>
        <ul id="list-choices">
            <li><input type="checkbox" class="correct_answers" checked="true"><input name="choices[]" type="text" class="choices" required></li>
            <li><input type="checkbox" class="correct_answers"><input name="choices[]" type="text" class="choices" required ></li>
        </ul>
        <template id="choice-input-template">
            <li><input type="checkbox" class="correct_answers"><input type="text" name="choices[]" required></li>
        </template>
    <br>
    <button onclick="addChoice()">Lisää valinta</button>
    <input type="submit" value="Luo tehtävä">
    </form>
</div>
<br style="line-height: 2">
<a href="/deletecourse?id={{course['id']}}" style="color: red">Poista kurssi</a>
<hr>
<h2>Tilastoja:</h2>
<!--Scripts for the buttons on this page-->
<script>
    function openForm() {
        const form = document.getElementById("exerciseform");
        if (form.style.display === "none") {
            form.style.display = "block";
        } else {
            form.style.display = "none";
        }
    }

    function openTextExercise() {
        var textForm = document.getElementById("textform");
        if (textForm.style.display === "none") {
            textForm.style.display = "block";
        } else {
            textForm.style.display ="none";
        }
        var multipleChoiceForm = document.getElementById("multiplechoiceform")
        if (multipleChoiceForm.style.display === "block") {
            multipleChoiceForm.style.display = "none"
        }
    }

    function openMultipleChoiceExercise() {
        var multipleChoiceForm = document.getElementById("multiplechoiceform");
        if (multipleChoiceForm.style.display === "none") {
            multipleChoiceForm.style.display = "block";
        } else {
            multipleChoiceForm.style.display ="none";
        }
        var textForm = document.getElementById("textform")
        if (textForm.style.display === "block") {
            textForm.style.display = "none"
        }
    }

    function addChoice() {
        const ul = document.getElementById("list-choices");
        const newChoice = document.getElementById("choice-input-template").content.cloneNode(true);
        ul.appendChild(newChoice);
    }

    function submit() {
        const choices = Array.from(document.getElementsByClassName("choices")).map(i => i.value);
        const correctAnswers = Array.from(document.getElementsByClassName("correct_answers")).map(i => i.checked)
    }
</script>
{% endblock %}
